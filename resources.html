<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover">
  <title>C2C Variations â€” Resources</title>
  <meta name="description" content="Browse featured government, council and compliance resources. Filter everything in real time and keep your search in the URL for easy sharing.">
  <link rel="icon" href="/favicon.ico">
  <link rel="apple-touch-icon" href="/apple-touch-icon.png">
  <link rel="preload" href="/site-mobile.css?v=8" as="style" onload="this.onload=null;this.rel='stylesheet'">
  <noscript><link rel="stylesheet" href="/site-mobile.css?v=8"></noscript>
  <link rel="stylesheet" href="/assets/site-nav.css?v=1">
  <link rel="stylesheet" href="/assets/nav-cta.hotfix.css?v=9">
  <link rel="stylesheet" href="/assets/chatbot.v6.css?v=1">
  <style>
    :root {
      color-scheme: dark;
    }

    body {
      margin: 0;
      background: #050505;
      color: #f5f5f5;
      font-family: "Inter", system-ui, -apple-system, "Segoe UI", Roboto, Arial, sans-serif;
      -webkit-font-smoothing: antialiased;
      text-rendering: optimizeLegibility;
    }

    main {
      max-width: 1080px;
      margin: 0 auto;
      padding: clamp(24px, 5vw, 64px) 24px 96px;
    }

    .hero {
      display: grid;
      gap: 16px;
      margin-bottom: clamp(32px, 5vw, 56px);
    }

    .hero-label {
      display: inline-flex;
      align-items: center;
      gap: 8px;
      padding: 6px 16px;
      border-radius: 999px;
      background: rgba(255, 153, 102, 0.12);
      color: #ffb48c;
      border: 1px solid rgba(255, 153, 102, 0.4);
      width: max-content;
      font-size: 0.85rem;
      letter-spacing: 0.08em;
      text-transform: uppercase;
    }

    h1 {
      margin: 0;
      font-size: clamp(2.8rem, 6vw, 3.8rem);
      letter-spacing: -0.02em;
    }

    .hero p {
      margin: 0;
      max-width: 680px;
      color: #d7d7d7;
      line-height: 1.6;
    }

    .toolbar {
      display: flex;
      flex-wrap: wrap;
      align-items: center;
      gap: 16px;
      margin-bottom: 32px;
    }

    .toolbar label {
      font-weight: 600;
      font-size: 0.95rem;
      color: #f0f0f0;
    }

    .search-input {
      flex: 1 1 260px;
      min-width: 220px;
      padding: 14px 16px;
      font-size: 1rem;
      border-radius: 14px;
      border: 1px solid #2a2a2a;
      background: #0f0f0f;
      color: inherit;
      transition: border-color 0.2s ease, box-shadow 0.2s ease;
    }

    .search-input:focus {
      outline: none;
      border-color: rgba(255, 153, 102, 0.75);
      box-shadow: 0 0 0 3px rgba(255, 153, 102, 0.2);
    }

    .summary {
      font-weight: 600;
      font-size: 0.95rem;
      color: #cfcfcf;
    }

    .muted {
      color: #9f9f9f;
    }

    section h2 {
      margin: 0 0 18px;
      font-size: clamp(1.6rem, 4vw, 2.3rem);
      letter-spacing: -0.01em;
    }

    .card-grid {
      display: grid;
      gap: 18px;
      grid-template-columns: repeat(auto-fit, minmax(260px, 1fr));
      margin: 0;
      padding: 0;
      list-style: none;
    }

    .resource-card {
      position: relative;
      display: flex;
      flex-direction: column;
      gap: 12px;
      background: #0b0b0b;
      border: 1px solid #1f1f1f;
      border-radius: 18px;
      padding: 20px;
      transition: border-color 0.2s ease, transform 0.2s ease;
    }

    .resource-card:hover,
    .resource-card:focus-within {
      border-color: rgba(255, 153, 102, 0.5);
      transform: translateY(-2px);
    }

    .resource-card h3 {
      margin: 0;
      font-size: 1.15rem;
    }

    .resource-card p {
      margin: 0;
      color: #b9b9b9;
      font-size: 0.95rem;
      line-height: 1.5;
    }

    .badge {
      display: inline-flex;
      align-items: center;
      gap: 6px;
      padding: 4px 12px;
      border-radius: 999px;
      background: #181818;
      color: #f4f4f4;
      border: 1px solid #2f2f2f;
      font-size: 0.75rem;
      text-transform: uppercase;
      letter-spacing: 0.05em;
      width: max-content;
    }

    .actions {
      display: flex;
      flex-wrap: wrap;
      gap: 10px;
      margin-top: auto;
    }

    .actions a,
    .actions button {
      flex: 1 1 100px;
      display: inline-flex;
      justify-content: center;
      align-items: center;
      gap: 8px;
      border-radius: 12px;
      padding: 10px 14px;
      font-weight: 600;
      font-size: 0.95rem;
      border: 1px solid #2a2a2a;
      background: #111;
      color: #fdfdfd;
      cursor: pointer;
      transition: border-color 0.2s ease, background 0.2s ease, transform 0.2s ease;
    }

    .actions a:hover,
    .actions a:focus,
    .actions button:hover,
    .actions button:focus {
      border-color: rgba(255, 153, 102, 0.65);
      background: #171717;
      outline: none;
    }

    .actions a[href] {
      text-decoration: none;
    }

    .actions .primary {
      background: linear-gradient(135deg, rgba(255, 153, 102, 0.2), rgba(255, 94, 58, 0.25));
      border: 1px solid rgba(255, 153, 102, 0.5);
    }

    .actions .saved {
      border-color: rgba(140, 232, 168, 0.6);
      background: rgba(31, 82, 55, 0.35);
    }

    .empty-state {
      display: none;
      margin-top: 32px;
      padding: 24px;
      border-radius: 18px;
      border: 1px dashed rgba(255, 153, 102, 0.45);
      background: rgba(255, 153, 102, 0.07);
      color: #f3c7b0;
      font-size: 1rem;
    }

    .toast {
      position: fixed;
      inset-inline-end: 24px;
      inset-block-end: 24px;
      padding: 14px 18px;
      border-radius: 14px;
      background: rgba(15, 15, 15, 0.92);
      border: 1px solid rgba(255, 153, 102, 0.45);
      color: #ffd7c4;
      font-size: 0.9rem;
      display: none;
      z-index: 4000;
    }

    @media (max-width: 720px) {
      .actions a,
      .actions button {
        flex: 1 1 100%;
      }

      main {
        padding-inline: 16px;
      }
    }
  </style>
</head>
<body>
  <header class="site-header" data-nav-root>
    <div class="container nav-row">
      <a class="brand" href="/index.html" aria-label="C2C Variations home">
        <img class="icon" src="/assets/logo-icon.jpg" alt="C2C icon">
      </a>
      <button class="nav-hamburger" type="button" data-nav-toggle aria-controls="main-nav" aria-expanded="false" aria-label="Open navigation">
        <span class="nav-hamburger-bar"></span>
        <span class="nav-hamburger-bar"></span>
        <span class="nav-hamburger-bar"></span>
      </button>
      <nav class="nav site-nav" id="main-nav" role="navigation" aria-label="Main" data-nav-menu>
        <a href="/index.html">Home</a>
        <a href="/pricing.html">Pricing</a>
        <a href="/about.html">About</a>
        <a href="/docs.html">Docs</a>
        <a href="/resources.html" aria-current="page">Resources</a>
        <a class="btn btn-wa" href="https://wa.me/61466873332?text=Hi%20C2C%2C%20keen%20to%20get%20set%20up.&utm_source=site&utm_medium=button&utm_campaign=whatsapp" target="_blank" rel="noopener">WhatsApp</a>
        <button type="button" id="c2c-chat-cta" class="c2c-chat-cta" aria-controls="c2c-chatbot-container" aria-expanded="false">ðŸ’¬ Chat with C2C</button>
      </nav>
    </div>
  </header>

  <main>
    <section class="hero">
      <span class="hero-label">Resource hub</span>
      <h1>Resources</h1>
      <p>Featured government warnings, council tools and compliance references â€” filtered in real time so field teams and schedulers can open, copy or save the links they need without breaking stride.</p>
    </section>

    <div class="toolbar" aria-live="polite" aria-atomic="true">
      <label for="resource-search">Search resources</label>
      <input id="resource-search" class="search-input" type="search" placeholder="Search by name, topic or region" autocomplete="off" spellcheck="false">
      <div class="summary" id="resource-summary">Loading resourcesâ€¦</div>
    </div>

    <p class="muted" id="resource-empty-global" hidden>No resources available yet.</p>

    <section aria-labelledby="featured-heading" id="featured-section">
      <h2 id="featured-heading">Featured</h2>
      <ul class="card-grid" id="featured-list"></ul>
    </section>

    <section aria-labelledby="all-heading" id="all-section" style="margin-top:48px;">
      <h2 id="all-heading">All resources</h2>
      <ul class="card-grid" id="resource-grid"></ul>
    </section>

    <div class="empty-state" id="empty-state" role="status">No resources match that search yet. Try another term such as <strong>outage</strong>, <strong>council</strong> or <strong>traffic</strong>.</div>
  </main>

  <div class="toast" id="resource-toast" role="status" aria-live="polite"></div>

  <script src="/assets/site-nav.js?v=1" defer></script>
  <script src="/assets/chatbot.v6.js" defer></script>
  <script src="/assets/resources.data.js"></script>
  <script>
    (function() {
      const searchInput = document.getElementById('resource-search');
      const summaryEl = document.getElementById('resource-summary');
      const featuredSection = document.getElementById('featured-section');
      const featuredList = document.getElementById('featured-list');
      const allSection = document.getElementById('all-section');
      const resourceGrid = document.getElementById('resource-grid');
      const emptyState = document.getElementById('empty-state');
      const emptyDataNotice = document.getElementById('resource-empty-global');
      const toast = document.getElementById('resource-toast');
      const allCards = [];
      const savedKey = 'c2c-saved-resources';
      let resources = [];
      let totalCount = 0;

      function showToast(message) {
        if (!toast) return;
        toast.textContent = message;
        toast.style.display = 'block';
        clearTimeout(showToast.timer);
        showToast.timer = setTimeout(() => {
          toast.style.display = 'none';
        }, 2400);
      }

      function getSavedSet() {
        try {
          return new Set(JSON.parse(localStorage.getItem(savedKey) || '[]'));
        } catch (error) {
          console.error(error);
          return new Set();
        }
      }

      function persistSaved(set) {
        try {
          localStorage.setItem(savedKey, JSON.stringify(Array.from(set)));
        } catch (error) {
          console.error(error);
        }
      }

      function createActionButton(label) {
        const btn = document.createElement('button');
        btn.type = 'button';
        btn.textContent = label;
        return btn;
      }

      function createCard(resource) {
        const li = document.createElement('li');
        li.className = 'resource-card';
        li.dataset.section = resource.featured ? 'featured' : 'catalogue';
        li.dataset.searchText = [
          resource.title,
          resource.url,
          resource.group || '',
          resource.category || '',
          (resource.tags || []).join(' ')
        ].join(' ').toLowerCase();

        const badge = document.createElement('span');
        badge.className = 'badge';
        badge.textContent = resource.group || (resource.featured ? 'Featured' : 'Resource');
        li.appendChild(badge);

        const heading = document.createElement('h3');
        heading.textContent = resource.title;
        li.appendChild(heading);

        const details = resource.description || resource.category;
        if (details) {
          const desc = document.createElement('p');
          desc.textContent = details;
          li.appendChild(desc);
        } else if (resource.tags && resource.tags.length) {
          const desc = document.createElement('p');
          desc.textContent = resource.tags.join(' â€¢ ');
          li.appendChild(desc);
        }

        const actions = document.createElement('div');
        actions.className = 'actions';

        const open = document.createElement('a');
        open.href = resource.url;
        open.target = '_blank';
        open.rel = 'noopener noreferrer';
        open.textContent = 'Open';
        open.classList.add('primary');
        actions.appendChild(open);

        const copy = createActionButton('Copy link');
        copy.addEventListener('click', async () => {
          try {
            await navigator.clipboard.writeText(resource.url);
            showToast('Link copied to clipboard');
          } catch (error) {
            console.error(error);
            showToast('Copy failed â€” open the link and share it manually.');
          }
        });
        actions.appendChild(copy);

        const saveBtn = createActionButton('Save');
        const saved = getSavedSet();
        if (saved.has(resource.url)) {
          saveBtn.classList.add('saved');
          saveBtn.textContent = 'Saved';
        }
        saveBtn.addEventListener('click', () => {
          const set = getSavedSet();
          if (set.has(resource.url)) {
            set.delete(resource.url);
            saveBtn.classList.remove('saved');
            saveBtn.textContent = 'Save';
            showToast('Removed from saved resources');
          } else {
            set.add(resource.url);
            saveBtn.classList.add('saved');
            saveBtn.textContent = 'Saved';
            showToast('Saved for this browser');
          }
          persistSaved(set);
        });
        actions.appendChild(saveBtn);

        li.appendChild(actions);
        return li;
      }

      function updateVisibility(query) {
        if (!totalCount) {
          if (summaryEl) {
            summaryEl.textContent = '';
          }
          if (emptyState) {
            emptyState.style.display = 'none';
          }
          if (featuredSection) {
            featuredSection.style.display = 'none';
          }
          if (allSection) {
            allSection.style.display = 'none';
          }
          return;
        }

        const q = (query || '').trim().toLowerCase();
        let visibleCount = 0;
        let featuredVisible = 0;

        allCards.forEach(card => {
          const match = !q || card.dataset.searchText.includes(q);
          card.style.display = match ? '' : 'none';
          if (match) {
            visibleCount += 1;
            if (card.dataset.section === 'featured') {
              featuredVisible += 1;
            }
          }
        });

        if (featuredSection) {
          featuredSection.style.display = featuredVisible ? '' : 'none';
        }

        if (allSection) {
          const catalogueVisible = visibleCount - featuredVisible;
          allSection.style.display = catalogueVisible ? '' : 'none';
        }

        if (emptyState) {
          emptyState.style.display = visibleCount === 0 ? 'block' : 'none';
        }

        if (summaryEl) {
          const label = visibleCount === 1 ? 'resource' : 'resources';
          summaryEl.textContent = `Showing ${visibleCount} of ${totalCount} ${label}`;
        }
      }

      function normaliseResource(item) {
        if (!item) return null;
        const title = (item.title || '').trim();
        const url = (item.url || '').trim();
        if (!title || !url) return null;
        const normalised = {
          id: item.id || url,
          title,
          url,
          tags: Array.isArray(item.tags) ? item.tags.filter(Boolean) : [],
          group: item.group || '',
          category: item.category || '',
          description: item.description || '',
          featured: Boolean(item.featured)
        };
        return normalised;
      }

      function normaliseList(list) {
        if (!Array.isArray(list)) return [];
        return list.map(normaliseResource).filter(Boolean);
      }

      function mergeResources(base, extra) {
        const map = new Map();
        base.forEach(resource => {
          const key = (resource.url || resource.id || '').toLowerCase();
          if (!key) return;
          map.set(key, { ...resource });
        });
        extra.forEach(resource => {
          if (!resource) return;
          const key = (resource.url || resource.id || '').toLowerCase();
          if (!key) return;
          if (map.has(key)) {
            const existing = map.get(key);
            existing.featured = existing.featured || resource.featured;
            if (!existing.description && resource.description) {
              existing.description = resource.description;
            }
            if (!existing.group && resource.group) {
              existing.group = resource.group;
            }
            if (!existing.category && resource.category) {
              existing.category = resource.category;
            }
            const combinedTags = new Set([...(existing.tags || []), ...(resource.tags || [])]);
            existing.tags = Array.from(combinedTags);
            map.set(key, existing);
          } else {
            map.set(key, { ...resource });
          }
        });
        return Array.from(map.values());
      }

      function flattenFromJson(payload) {
        if (!payload || typeof payload !== 'object') return [];
        const flattened = [];
        const shortcuts = Array.isArray(payload.shortcuts) ? payload.shortcuts : [];
        shortcuts.forEach((shortcut, index) => {
          flattened.push(normaliseResource({
            id: shortcut && (shortcut.id || `shortcut-${index}`),
            title: shortcut && shortcut.label,
            url: shortcut && shortcut.url,
            tags: shortcut && shortcut.tags,
            group: 'Shortcut',
            category: 'Featured',
            description: 'Shortcut link',
            featured: true
          }));
        });

        const byState = payload.by_state || {};
        Object.entries(byState).forEach(([state, categories]) => {
          Object.entries(categories || {}).forEach(([category, entries]) => {
            (entries || []).forEach(entry => {
              if (!Array.isArray(entry) || entry.length < 2) return;
              const [title, url] = entry;
              flattened.push(normaliseResource({
                title,
                url,
                tags: [state, category],
                group: state,
                category
              }));
            });
          });
        });

        const otherCategories = payload.other_categories || {};
        Object.entries(otherCategories).forEach(([category, entries]) => {
          (entries || []).forEach(entry => {
            if (!Array.isArray(entry) || entry.length < 2) return;
            const [title, url] = entry;
            flattened.push(normaliseResource({
                title,
                url,
                tags: [category, 'national'],
                group: 'National',
                category
            }));
          });
        });

        return flattened.filter(Boolean);
      }

      function rebuildCards(list) {
        featuredList.innerHTML = '';
        resourceGrid.innerHTML = '';
        allCards.length = 0;
        totalCount = Array.isArray(list) ? list.length : 0;

        if (emptyDataNotice) {
          emptyDataNotice.hidden = totalCount !== 0;
        }

        if (!totalCount) {
          if (featuredSection) featuredSection.style.display = 'none';
          if (allSection) allSection.style.display = 'none';
          if (summaryEl) summaryEl.textContent = '';
          if (emptyState) emptyState.style.display = 'none';
          return;
        }

        list.forEach(resource => {
          const card = createCard(resource);
          allCards.push(card);
          if (resource.featured) {
            featuredList.appendChild(card);
          } else {
            resourceGrid.appendChild(card);
          }
        });

        if (featuredSection) {
          featuredSection.style.display = featuredList.children.length ? '' : 'none';
        }

        if (allSection) {
          allSection.style.display = resourceGrid.children.length ? '' : 'none';
        }

        updateVisibility(searchInput ? searchInput.value : '');
      }

      function readHashQuery() {
        const hash = location.hash.startsWith('#') ? location.hash.slice(1) : location.hash;
        if (!hash) return '';
        const params = new URLSearchParams(hash);
        return (params.get('q') || '').trim();
      }

      function writeHashQuery(value) {
        const hash = location.hash.startsWith('#') ? location.hash.slice(1) : location.hash;
        const params = new URLSearchParams(hash);
        if (value) {
          params.set('q', value);
        } else {
          params.delete('q');
        }
        const nextHash = params.toString();
        const nextUrl = nextHash ? `${location.pathname}${location.search}#${nextHash}` : `${location.pathname}${location.search}`;
        history.replaceState(null, '', nextUrl);
      }

      const builtIn = normaliseList(window.C2C_RESOURCES || []);
      if (searchInput) {
        const initialQuery = readHashQuery();
        if (initialQuery) {
          searchInput.value = initialQuery;
        }
      }

      resources = mergeResources([], builtIn);
      rebuildCards(resources);

      fetch('/data/resources.json', { cache: 'no-store' })
        .then(resp => resp.ok ? resp.json() : Promise.reject(new Error(`HTTP ${resp.status}`)))
        .then(payload => {
          const extra = flattenFromJson(payload);
          if (extra.length) {
            resources = mergeResources(resources, extra);
            rebuildCards(resources);
          }
        })
        .catch(error => {
          console.warn('Resource JSON fallback triggered', error);
          if (!resources.length) {
            rebuildCards([]);
          }
        });

      if (searchInput) {
        searchInput.addEventListener('input', event => {
          const value = event.target.value || '';
          writeHashQuery(value.trim());
          updateVisibility(value);
        });
      }

      window.addEventListener('hashchange', () => {
        const next = readHashQuery();
        if (searchInput && next !== searchInput.value) {
          searchInput.value = next;
        }
        updateVisibility(next);
      });
    })();
  </script>
</body>
</html>
